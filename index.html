<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <title>Watchlist</title>
    <style>
        body {
            background-image: url("fotograf/cesar-couto-sKuVjm0xyLY-unsplash.jpg");
            background-size: cover;
            background-repeat: no-repeat;
        }

        .row {
            width: auto;
        }
    </style>

</head>

<body>
    <div class="container container-sm container mt-5">
        <h1 class="text-center fw-bold text-white-50" ; style="font-variant: small-caps;">watchlist web uygulaması</h1>



        <div class="row container border-end border-start border-top border-3 border-warning rounded-3 container mb-2 bg-dark">
            <div class="col">
                <p class="fw-bold fs-4 pt-3 text-white">Bu sayfada size react kullanarak yaptığım film izleme listesi oluşturma web uygulamasının sürecini göstereceğim.<br><br> <a
                        href="https://github.com/umutcanozer/wathclist-movie"
                        class="list-group-item list-group-item-action list-group-item-secondary" 
                        style="width: fit-content;">PROJE SAYFASI</a> 
            </div>
            <div class="col">
                <p class="fw-bold fs-4 pt-3 text-white">Öncelikle başlamadan önce bir kaç kurulum yapıp projeyi oluşturmamız gerekiyor. <br>
                    <ul class="text-white fs-3">
                        <li>Node.js</li>
                        <li>React projesini oluşturma</li>
                        <li>API key alımı</li>
                    </ul>
                </p>
            </div>
        </div>


        

        <div class="container border-end border-start border-bottom border-3 border-warning rounded-3 container mb-2 bg-dark">
            <div class="row">
                <div class="col text-white">
                    <img src="fotograf/nodejs.jpg" alt="giris" class="img-fluid mt-3">
                    <p class="fw-bold fs-4 text-center">Öncelikle <a href="https://nodejs.org/en/" class="text-white-50">https://nodejs.org/en/</a> sitesine girerek LTS sürümünü indiriniz.</p>
                </div>
                <div class="col text-white">
                    <img src="fotograf/nodejscommand.jpg" alt="giris" class="img-fluid mt-3">
                    <p class="fw-bold fs-4 ">Öncelikle node.js command prompt uygulamasını açınız ve aşağıda belirtilen kodları giriniz.</p>
                    <ul class="text-white fs-3">
                        <li>Projeyi oluşturma</li>
                        <li>Komut bloğunu projenin konumuna yönlendirme</li>
                        <li>Bootstrap yükleme</li>
                    </ul>
                    <p class="fw-bold fs-4 text-center">npx create-react-app movie-app</p>
                    <p class="fw-bold fs-4 text-center">cd movie app</p>
                    <p class="fw-bold fs-4 text-center">npx create-react-app movie-app</p>
                </div>
                <div class="col text-center text-white">
                    <img src="fotograf/api.jpg" alt="giris" class="img-fluid mt-3">
                    <p class="fw-bold fs-4 text-center">Daha sonra <a href="https://www.omdbapi.com/apikey.aspx" class="text-white-50">https://www.omdbapi.com/apikey.aspx</a> sitesine girerek gerekli kutucukları doldurunuz ve API key elde ediniz. E-posta yoluyla size ulaştıralacaktır ve girip aktive etmeniz gerekmektedir.</p>
                </div>
            </div>
        </div>


        <div class="row container border-end border-start border-top border-3 border-warning rounded-3 container mb-2 bg-dark">
          <div class="col text-white">
            <p class="fw-bold fs-4 ">Projemizi oluşturduk. Şimdi projemizin içinde "src" klasörü altına yeni dosya diyerek "Components" klasörü oluşturunuz. React'da component mantığı en basit haliyle bizim programızı bölümlere ayırıp, okunabilirliği arttırmaya yarar sağlar. Daha sonra bu klasör içine ".js" dosyaları oluşturup iskeletleri kuracağız.</p>

            <pre class="fs-5"><code>
                &lt;MovieListHeading heading='Movies' /&gt;
                &lt;DarkMode /&gt;
                &lt;SearchBox searchValue={searchValue} setSearchValue={setSearchValue} /&gt;
            </code></pre>
            <p class="fw-bold fs-4 ">Daha sonra üstte gördüğünüz şekilde bu componentleri "App.js" içinde çağıracağız. DarkMode tema için, SearchBox arama kutusu için MovieListHeading ise büyük başlıkları temsil etmektedir.</p>
            <p class="fw-bold fs-4 ">Uygulamamız "App.js" üzerinden çalışacaktır. Oluşturduğunuz componentleri ve "App.css" dosyasını bu dosya içine import etmeyi unutmayınız. "App.css" ise uygulamamızın css dosyası olacaktır. Proje bittiğinde componentlerle birlikte import kısmı bu şekilde olacaktır.</p>
            <pre class="fs-5"><code>
                import React, { useEffect, useState }  from 'react';
                import 'bootstrap/dist/css/bootstrap.min.css';
                import './App.css';
                import MovieList from './components/MovieList';
                import MovieListHeading from './components/MovieListHeading';
                import SearchBox from './components/SearchBox';
                import Add from './components/Add';
                import RemoveWatched from './components/RemoveWatched';
                import DarkMode from './components/DarkMode';
            </code></pre>
            </div>
        </div>




        <div class="container border-end border-start border-bottom border-3 border-warning rounded-3 container mb-2 bg-dark">
            <div>
                <p class="fs-4 text-white fw-bold">Öncelikle API'den çektiğimiz filmleri sitemizde görüntelememiz gerek bunun için component içine "MovieList.js" dosyası açmalıyız. Daha sonra App.js içinde useState bloğu açmalıyız. useState bloğu okuma ve yazma işlevi görür. [movies, setMovies] kısmında movies read, setMovies ise write için kullanılır. useState kullanımı proje bittiğinde bu şekilde olacaktır.</p>
                <pre class="fs-4"><code>
const [movies, setMovies] = useState([]);
const [adds, setAdds] = useState([]);
const [searchValue, setSearchValue] = useState('');

&lt;MovieList movies={movies} 
handleAddsClick={addMovie} 
AddComponent={Add} /&gt;

                
                </code></pre>
                
                <p class="fs-4 text-white fw-bold">"MovieList.js" componentin iç kısmı da bu şekildedir. "App.js" içinde movies değişkenlerini componentteki movies ile eşitledik. daha sonra props.movies.map kullanarak filmlerimizi görüntüledik. Props dışarıdan gelen verinin tutulması için kullanılır. map ise dizi içindeki elemanları ekrana basar. onClick eventi ile de daha sonra bahsedeceğim "AddComponent" kısmındaki vereceğimiz yazının üstüne tıklayarak çalıştıralacak bir fonksiyon sağladık. Bu fonksiyon istediğimiz filmleri watchlist'e eklememizi sağlayacak.</p>

                <pre class="fs-4"><code>
 import React from 'react';

    const MovieList = (props) => {
    const AddComponent = props.AddComponent;
        return (
            &lt;&gt;
              {props.movies.map((movie, index) => (
                &lt;div className='image-container d-flex justify-content-start m-3'&gt;
                    &lt;img src={movie.Poster} alt='movie'&gt;&lt;/img&gt;
                    &lt;div onClick={()=>props.handleAddsClick(movie)} className='overlay d-flex aligh-items-center justify-content-center'&gt;
                    &lt;AddComponent /&gt;
                    &lt;/div&gt;
                 &lt;/div&gt;
))}
            &lt;/&gt;)
                            
};


export default MovieList;

                </code></pre>
            </div>


            <div>
                <p class="fs-4 text-white fw-bold"> Bu kısımda da API'den filmleri çekmeyi ve arama yaparak bu fimleri ekrana getirmeyi yazdık fakat search kısmına daha sonra değineceğim. await denilerek işleminin sonucu alınana kadar beklenmesini istedik. await kullanabilmik için async fonksiyona ihtiyacımız var bunun için aşağıda gördüğünüz şekilde async olduğunu belirterek await kullabiliyoruz. Link içindeki ${searchValue} ise kullanıcının girdisini okuyup istenilen API verisinin çekilmesini sağlıyor. Buna başta useState'i anlatırken değinmiştim. useState'de verdiğimiz ilk değer read işlemi içindir. if bloğu ise responseJson'a atama yapmıştık eğer içinde bir şey barındırıyorsa, o veriyi yazdırmasını sağlıyoruz. </p>
                <pre class="fs-4"><code>
const getMovieRequest = async (searchValue) => {
    const url = `http://www.omdbapi.com/?s=${searchValue}&apikey=263d22d8`;
                      
    const response = await fetch(url);
    const responseJson = await response.json();
                      
    if(responseJson.Search) {
    setMovies(responseJson.Search);
    }
                        
};

                </code></pre>
            </div>

            <div>
                <p class="fs-4 text-white fw-bold">Burda da üstte oluşturduğumuz fonksiyonu çağırdık. useEffect sitenin daha optimize çalışması için kullanılıyor. useEffect'in altında verilen array içindeki değer değiştiği zaman çalışıyor ve fonksiyon çağırılıyor. searchValue değerine bir sonraki kodda değiniyoruz.</p>
                <pre class="fs-4"><code>
useEffect(()=>{
    getMovieRequest(searchValue);
}, [searchValue]);
                </code></pre>
            </div>

            <div>
                <p class="fs-4 text-white fw-bold">Şimdi search box oluşturup aranacak filmleri inputla bağdaştırmalıyız. Bunun için önce "SearchBox.js" componenti oluşturmalıyız. İçindeki kodlar aşağıdaki gibi olmalı. input ve form-control kullanarak search box'u oluşturduk. daha sonra kullanıcının gireceği değer için value değerini atadık ve girdi değişiminde tekrarlanması için onChange kullandık. </p>
                <pre class="fs-4"><code>
import React from 'react';

    const SearchBox = (props) => {
        return (
            &lt;div className='col col-sm-4'&gt;
                &lt;input 
                className='form-control' 
                value ={props.value}
                onChange={(event)=> props.setSearchValue(event.target.value)}
                placeholder='Type to search...'&gt;&lt;/input&gt;
            &lt;/div&gt;
        );
    };
                    
    export default SearchBox;

                </code></pre>
            </div>

            <div>
                <p class="fs-4 text-white fw-bold">Daha öce "App.js" dosyası içinde SearchValue için useState açmıştık. Şimdi açtığımız component dosyasını çağırmalıyız. Ardından component ve "App.js" içindeki değerleri eşitlemeliyiz.</p>
                <pre class="fs-4"><code>
&lt;SearchBox searchValue={searchValue} setSearchValue={setSearchValue} /&gt;
                </code></pre>
            </div>

            <div>
                <p class="fs-4 text-white fw-bold">Şimdi components içinde "Add.js" dosyası açınız ve içine aşağıdaki kodları yerleştiriniz. Poster üstünde görüntelenecek yazıyı burada ekleyeceksiniz. İsterseniz internetten başka ikonlar bularak değiştirebilirsiniz. Daha önce "MovieList.js" içinde AddComponent değerini atayıp içinde çağırmıştık ve "App.js" dosyası içinde de aşağıda verdiğimiz componenti atadık. Bu sayede poster üzerine gereken yazıyı burdan ve yukarıda bahsetmiş olduğum üzerine tıklanarak elde edilen fonksiyonu ise "MovieList.js" dosyasında elde ederek yerleştirdik.</p>
                <pre class="fs-4"><code>
import React from 'react';

const Add = () => {
    return (
        &lt;&gt;
            &lt;span className='mr-2'&gt;add to watch list&lt;svg 
            xmlns="http://www.w3.org/2000/svg" 
            width="16" 
            height="16" 
            fill='purple'
            class="bi bi-film" 
            viewBox="0 0 16 16"&gt;
            &lt;path d="M0 1a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V1zm4 0v6h8V1H4zm8 8H4v6h8V9zM1 1v2h2V1H1zm2 3H1v2h2V4zM1 7v2h2V7H1zm2 3H1v2h2v-2zm-2 3v2h2v-2H1zM15 1h-2v2h2V1zm-2 3v2h2V4h-2zm2 3h-2v2h2V7zm-2 3v2h2v-2h-2zm2 3h-2v2h2v-2z"/&gt;       
                               
            &lt;/svg&gt;&lt;/span&gt;
                    
                               
        &lt;/&gt;
    );
};
                    
export default Add;
                </code></pre>
            </div>

            <div>
                <p class="fs-4 text-white fw-bold">Şimdi filmlerimizi watchliste ekleme fonksiyonunu yazacağız. Daha önce ilk kısmında adds ve setAdds şeklinde useState göstermiştim, onları kullancağız bu kısımda. Ayrıca MovieList componentini çağırırken de handleAddsClick belirterek içine addMovie fonksiyonunu atadık. Fonksiyon aşağıdaki gibidir. newAddList ile kopya oluşturduk ve içinde girilip okunacak değer movie ve okuması içinde useState'den adds'i ekledik. Daha sonra setAdds ile yazmazı için array'i içine verdik.</p>
                <pre class="fs-4"><code>
const addMovie = (movie) => {
    const newAddList = [...adds, movie];
    setAdds(newAddList);
    saveToLocalStorage(newAddList);
};
                </code></pre>
            </div>

            <div>
                <p class="fs-4 text-white fw-bold">Daha sonra listemize eklediklerimizi görüntülemek için tekrar MovieList çağırıyoruz fakat içine bu sefer movies elementi yerine adds elementini ekliyoruz. Ayrıca removeMovie ve RemoveWatched elementlerini de ekliyoruz. Bunun sebebi bu sefer izlenecek listesinden çıkarmak istediğimiz filmleri çıkarmak için silme işlemi yapacağız. Bir dahaki blokta buna değineceğiz.</p>
                <pre class="fs-4"><code>
&lt;div className='row'&gt;
    &lt;MovieList movies={adds} 
    handleAddsClick={removeMovie} 
    AddComponent={RemoveWatched} /&gt;
&lt;/div&gt;

                </code></pre>
            </div>

            <div>
                <p class="fs-4 text-white fw-bold">Şimdi yeni bir component oluşturup ismini "RemoveWatched.js" yapınız. Bu componentin için aşağıdaki gibi olacaktır. Şimdi sıra üstte bahsettiğimiz removeMovie fonksiyonunu yazmakta.</p>
                <pre class="fs-4"><code>
import React from 'react';

const RemoveWatched = () => {
    return (
        &lt;&gt;
        &lt;span className='mr-2'&gt;remove from watchlist&lt;svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="red" class="bi bi-x-circle" viewBox="0 0 16 16"&gt;
        &lt;path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/&gt;
        &lt;path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/&gt;
        &lt;/svg&gt;&lt;/span&gt;
        &lt;/&gt;
    );
};
                    
export default RemoveWatched;
                </code></pre>
            </div>

            <div>
                <p class="fs-4 text-white fw-bold">Oluşturduğumuz fonksiyonda filter kullandık. Filter'da verilen konuş false dönerse sonuçlar elenir, true dönerse array'in üzerinde kalır. Daha sonra tekrar kopyasını oluşturduğumuz array'i setAdds'e atıyoruz. Bu sayede verdiğimiz koşul sayesinde bir sonuç alamayacağımız için eklediğimiz eleman silinir fonksiyon çağrıldığında. saveToLocalStorage'a daha sonra değineceğiz. imdbID ise API'den gelen her film için özel olan ID'lerdir.</p>
                <pre class="fs-4"><code>
const removeMovie = (movie) => {
    const newAddList = adds.filter((add)=> add.imdbID !== movie.imdbID);
    setAdds(newAddList);
    saveToLocalStorage(newAddList);
};
                </code></pre>
            </div>

            <div>
                <p class="fs-4 text-white fw-bold">Şimdi eklediğimiz filmlere ilerleyen zamanlarda bakmamız gerekirse silinmemiş olması için localStorage kullanacağız. Öncelikle aşağıdaki gibi bir fonksiyon açınız. localStorage içine key ve value yazdık. key: Değerin hangi isimle depolanacağını belirtir. value: Depolanacak değeri belirtir. Kısacası localStorage değerlerin depolanmasını sağlar. JSON.stringfy ise içindeki objeyi string ifadeye dönüştürür. Son olarak bu fonksiyonu add ve remove fonksiyonlarının içinde çağırıyoruz. </p>
                <pre class="fs-4"><code>
const saveToLocalStorage = (items) => {
    localStorage.setItem('react-movie-app-watchlist', JSON.stringify(items))
}
                </code></pre>
            </div>

            <div>
                <p class="fs-4 text-white fw-bold">Tekrar useEffect kullanıyoruz. Sondaki boş kutucuğu koyma sebebimiz bu bloğun sadece sayfa yeniden render edildiğinde yani açıldığında çalışmasını sağlıyoruz. Optimize olması için önemli. daha sonra JSON.parse kullanarak daha önce set ederken verdiğimiz key ismini kullanarak get ediyoruz. JSON.parse burada daha önce stringe dönüştürdüğümüz değerleri objeye dönüştürüyor ve setAdds kullanarak yazma işlemini gerçekleştiriyoruz.</p>
                <pre class="fs-4"><code>
useEffect(()=>{
    const movieWatchlist = JSON.parse(
    localStorage.getItem('react-movie-app-watchlist')
    );
                      
    setAdds(movieWatchlist);
}, []);
                </code></pre>
            </div>

            <!---<div>
                <p class="fs-4 text-white fw-bold"></p>
                <pre class="fs-4"><code>

                </code></pre>
            </div>-->
        </div>
</div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous">
    </script>
</body>